group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`), Año)%>%
ggplot(aes(x=`Entidad Federativa`, y=avg, col="green"))+
theme(axis.text.x = element_text(angle = 90))+
geom_bar(stat = "identity")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`), Año)%>%
ggplot(aes(x=`Entidad Federativa`, y=avg, col="forest green"))+
theme(axis.text.x = element_text(angle = 90))+
geom_bar(stat = "identity")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`), Año)%>%
ggplot(aes(x=`Entidad Federativa`, y=avg, fill="forest green"))+
theme(axis.text.x = element_text(angle = 90))+
geom_bar(stat = "identity")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`), Año)
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`), Año)%>%
ggplot(aes(x=`Entidad Federativa`, y=avg, color="forest green"))+
theme(axis.text.x = element_text(angle = 90))+
geom_bar(stat = "identity")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`), Año)%>%
ggplot(aes(x=`Entidad Federativa`, y=avg))+
theme(axis.text.x = element_text(angle = 90))+
geom_bar(stat = "identity", color="blue")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`), Año)%>%
ggplot(aes(x=`Entidad Federativa`, y=avg))+
theme(axis.text.x = element_text(angle = 90))+
geom_bar(stat = "identity", color="ligth blue")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`), Año)%>%
ggplot(aes(x=`Entidad Federativa`, y=avg))+
theme(axis.text.x = element_text(angle = 90))+
geom_bar(stat = "identity", color="forest green")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`), Año)%>%
ggplot(aes(x=`Entidad Federativa`, y=avg))+
theme(axis.text.x = element_text(angle = 90))+
geom_bar(stat = "identity", fill="forest green")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%.$avg%>%max
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
+     group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%.$avg%>%max()
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
+     group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%.$avg%>%max()
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%.$avg%>%max()
#Valor promedio de población desempleada en México
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%.$avg%>%max()
#Fila de la Ciudad de México
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%filter(`Entidad Federativa`=="Ciudad de México")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%
ggplot(aes(x=`Entidad Federativa`, y=avg))+
theme(axis.text.x = element_text(angle = 90))+
geom_bar(stat = "identity", fill="forest green")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%
ggplot(aes(x=`Entidad Federativa`, y=avg))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Promedio de población desocupada (2010-2019")+
ggtitle("Figura 5. Promedio de población desocupada (2010-2019) vs Ent. Federativa")+
geom_bar(stat = "identity", fill="forest green")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%
ggplot(aes(x=`Entidad Federativa`, y=avg))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Promedio de población desocupada (2010-2019")+
ggtitle("Figura 5. Promedio de población desocupada (2010-2019) vs Estado")+
geom_bar(stat = "identity", fill="forest green")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%
ggplot(aes(x=`Entidad Federativa`, y=avg))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Promedio de población desocupada")+
ggtitle("Figura 5. Promedio de población desocupada (2010-2019) vs Estado")+
geom_bar(stat = "identity", fill="forest green")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%
ggplot(aes(x=`Entidad Federativa`, y=avg))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Promedio de población desocupada")+
ggtitle("Figura 5. Promedio de población desocupada (2010-2019) vs Estado")+
geom_bar(stat = "identity", fill="forest green", position="dodge")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%reorder()
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%reorder(avg)
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%
ggplot(aes(x=`Entidad Federativa`, y=avg))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Promedio de población desocupada")+
ggtitle("Figura 5. Promedio de población desocupada (2010-2019) vs Estado")+
geom_bar(stat = "identity", fill="forest green")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%
ggplot(aes(x=reorder(`Entidad Federativa`), y=avg))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Promedio de población desocupada")+
ggtitle("Figura 5. Promedio de población desocupada (2010-2019) vs Estado")+
geom_bar(stat = "identity", fill="forest green")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%
ggplot(aes(x=reorder(-`Entidad Federativa`), y=avg))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Promedio de población desocupada")+
ggtitle("Figura 5. Promedio de población desocupada (2010-2019) vs Estado")+
geom_bar(stat = "identity", fill="forest green")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%
ggplot(aes(x=reorder(`Entidad Federativa`, -avg), y=avg))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Promedio de población desocupada")+
ggtitle("Figura 5. Promedio de población desocupada (2010-2019) vs Estado")+
geom_bar(stat = "identity", fill="forest green")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%
ggplot(aes(x=reorder(`Entidad Federativa`, -avg), y=avg))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Promedio de población desocupada")+
ggtitle("Figura 6. Promedio población desocupada (2010-2019) vs Estado (desc.)")+
geom_bar(stat = "identity", fill="forest green")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%
ggplot(aes(x=reorder(`Entidad Federativa`, -avg), y=avg))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Promedio de población desocupada")+
xlab("Entidad Federativa")+
ggtitle("Figura 6. Promedio población desocupada (2010-2019) vs Estado (desc.)")+
geom_bar(stat = "identity", fill="forest green")
knitr::opts_chunk$set(echo = TRUE)
library("readxl") #Esta librería permite descargar archivos Excel.
library("tidyverse") #Esta librería contiene múltiples librerías para facilitar el trabajo
pob_edad <- read_excel("INEGI_pob_edad.xls")
pob_edad[,c(1,2,3)] #Se ven las primeras 3 columnas de la base de datos
names(pob_edad)
n_pob_edad <- pob_edad%>%select(c(-2,-3,-4)) #No contiene datos del año 2020
head(n_pob_edad)
#Se hace un ciclo for para obtener el promedio de los trimestres para cada año
y <- 2019
k <- 0
year_pob_edad <- data.frame(n_pob_edad[,1])
for (i in 1:10){
col <- rowMeans(n_pob_edad[, k+c(2,3,4,5)])
year_pob_edad <- cbind(year_pob_edad, col)
names(year_pob_edad)[i+1]<-y
k <- k+4
y<-y-1
}
head(year_pob_edad) #Se observan los datos
edad_pob_edad <- data.frame("Edad"=c("Total", "15 a 19", "20 a 29", "30 a 39", "40 a 49", "50 a 59", "60≤", "No especificado"))
edad_pob_edad <- data.frame("Edad"=rep(edad_pob_edad[,1], 10))#Se crea data frame con rangos de edad
pob_pob_edad <- data.frame(year_pob_edad[ ,2]) #Se crea un data frame para guardar la población desocupada
#Se hace un ciclo for para acomodar a la población desocupada de manera vertical
c <- 3
k <- 1
for (i in 1:72){
row <- year_pob_edad[k ,c]
pob_pob_edad <- rbind(pob_pob_edad, row)
k <- k+1
if (k==9){
k <- 1
c <- c+1
}
}
pob_pob_edad
y_pob_edad <- data.frame(rep(2019, 8))#Se crea data frame con años
#Se hace un ciclo for para agregar años
y <- 2018
c<-0
for (j in 1:72){
y_pob_edad <- rbind(y_pob_edad, y)
c <- c+1
if (c==8){
c <- 0
y <- y-1
}
}
y_pob_edad
an_pob_edad<-cbind(edad_pob_edad, y_pob_edad, pob_pob_edad)
names(an_pob_edad) <- c("Edad", "Año", "Población Desocupada")
an_pob_edad #Data frame para realizar análisis visual
an_pob_edad[an_pob_edad[,1]!="Total",]%>%group_by(Edad)%>%summarise(avg=mean(`Población Desocupada`))%>%
ggplot(aes(Edad, avg))+ylab("Población desocupada promedio")+xlab("Rango de edad")+ggtitle("Figura 1. Población desocupada por rango de edad (2010-2019)")+geom_bar(stat = "identity")
#Bar plot
an_pob_edad[an_pob_edad[,1]!="Total",]%>%group_by(Año)%>%ggplot(aes(x=factor(Año), y=`Población Desocupada`, col=Edad))+xlab("Año")+ggtitle("Figura 2. Población desocupada por año y por rango de edad ")+geom_bar(stat = "identity")
#Base de datos con población desocupada total por año
y_pob <- an_pob_edad[an_pob_edad[,1]!="Total",]%>%group_by(Año)%>%summarise(`Población Desocupada`=sum(`Población Desocupada`))
y_pob
#Scatterplot
y_pob %>% ggplot(aes(x=factor(Año), y=`Población Desocupada`, col=factor(Año)))+xlab("Año")+ggtitle("Figura 3. Población desocupada por año")+geom_point()
an_pob_edad[an_pob_edad[,1]!="Total",]%>%group_by(Año)%>%ggplot(aes(x=Año, y=`Población Desocupada`, col=Edad))+ggtitle("Figura 4. Población desocupada por año y por edad")+geom_line()+geom_point()
pob_ent_fed <- read_excel("INEGI_pob_entfed.xlsx") #Data frame con datos depurados
summary(pob_ent_fed)
head(pob_ent_fed)#Primeros 6 renglones
tail(pob_ent_fed)#Últimas 6 filas
str(pob_ent_fed) #Estructura de la base de datos
levels(factor(pob_ent_fed$`Entidad Federativa`))
levels(factor(pob_ent_fed$`Periodo de encuesta`))
pob_ent_fed1 <- pob_ent_fed%>%filter(!(`Periodo de encuesta` %in% c("Cuarto trimestre del 2020", "Tercer trimestre del 2020", "Primer trimestre del 2020")))
pob_ent_fed1
pob_ent_fed1[1:4,]
k <- 0
y <- 2019
avg <- data.frame()
year <- data.frame()
ent <- data.frame()
for (i in 1:330){
tot_avg <- colMeans(pob_ent_fed1[k+1:4,"Total"])
avg <- rbind(avg, tot_avg)
ent <- rbind(ent, unique(pob_ent_fed1[k+1:4,"Entidad Federativa"]))
k <- k+4
year <- rbind(year, y)
y <- y-1
if (y==2009){
y<-2019
}
}
av_pobent_fed <- cbind(year, avg, ent)
names(av_pobent_fed)<-c("Año", "Población Desocupada", "Entidad Federativa")
av_pobent_fed
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%
ggplot(aes(x=`Entidad Federativa`, y=avg))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Promedio de población desocupada")+
ggtitle("Figura 5. Promedio de población desocupada (2010-2019) vs Estado")+
geom_bar(stat = "identity", fill="forest green")
#Valor promedio de población desempleada en México
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%.$avg%>%max()
#Fila de la Ciudad de México
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%filter(`Entidad Federativa`=="Ciudad de México")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%
ggplot(aes(x=reorder(`Entidad Federativa`, -avg), y=avg))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Promedio de población desocupada")+
xlab("Entidad Federativa")+
ggtitle("Figura 6. Promedio población desocupada (2010-2019) vs Estado (desc.)")+
geom_bar(stat = "identity", fill="forest green")
av_pobent_fed
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))
df <- av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))
df
df <- av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))
df
df[5,]
df
pob_tot_ent <- c(1273404, 3443792, 745601, 897291, 5200849, 3681473, 8870622, 2932657, 713612, 1750791, 5780123, 3551527, 2850714, 7857979, 16672099, 4571000, 1902329, 1206119, 5028766, 3991911, 6144886, 1980225, 1539101, 2733708, 2965379, 2900849, 2364632, 3511463, 1265055, 7998824, 2097203, 1566089)
df1 <- cbind(df, pob_tot_ent)
df1
pob_tot_ent <- c(1273404, 3443792, 745601, 897291, 5200849, 3681473, 8870622, 2932657, 713612, 1750791, 5780123, 3551527, 2850714, 7857979, 16672099, 4571000, 1902329, 1206119, 5028766, 3991911, 6144886, 1980225, 1539101, 2733708, 2965379, 2900849, 2364632, 3511463, 1265055, 7998824, 2097203, 1566089)
df1 <- cbind(df, pob_tot_ent)
df1 %>% summarise(tasa_deso=(avg/pob_tot_ent), `Entidad Federativa`) %>%
ggplot(aes(x=reorder(`Entidad Federativa`, -tasa_deso), y=tasa_deso))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Tasa de población desocupada")+
xlab("Entidad Federativa")+
ggtitle("Figura 7. Tasa de población desocupada (2010-2019) vs Entidad Federativa")
geom_bar(stat = "identity")
pob_tot_ent <- c(1273404, 3443792, 745601, 897291, 5200849, 3681473, 8870622, 2932657, 713612, 1750791, 5780123, 3551527, 2850714, 7857979, 16672099, 4571000, 1902329, 1206119, 5028766, 3991911, 6144886, 1980225, 1539101, 2733708, 2965379, 2900849, 2364632, 3511463, 1265055, 7998824, 2097203, 1566089)
df1 <- cbind(df, pob_tot_ent)
df1 %>% summarise(tasa_deso=(avg/pob_tot_ent), `Entidad Federativa`) %>%
ggplot(aes(x=reorder(`Entidad Federativa`, -tasa_deso), y=tasa_deso))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Tasa de población desocupada")+
xlab("Entidad Federativa")+
ggtitle("Figura 7. Tasa de población desocupada (2010-2019) vs Entidad Federativa")+
geom_bar(stat = "identity")
pob_tot_ent <- c(1273404, 3443792, 745601, 897291, 5200849, 3681473, 8870622, 2932657, 713612, 1750791, 5780123, 3551527, 2850714, 7857979, 16672099, 4571000, 1902329, 1206119, 5028766, 3991911, 6144886, 1980225, 1539101, 2733708, 2965379, 2900849, 2364632, 3511463, 1265055, 7998824, 2097203, 1566089)
df1 <- cbind(df, pob_tot_ent)
df1 %>% summarise(tasa_deso=(avg/pob_tot_ent), `Entidad Federativa`) %>%
ggplot(aes(x=reorder(`Entidad Federativa`, -tasa_deso), y=tasa_deso))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Tasa de población desocupada")+
xlab("Entidad Federativa")+
ggtitle("Figura 7. Tasa de población desocupada (2010-2019) vs Entidad Federativa")+
geom_bar(stat = "identity", fill="blue")
an_pob_edad[an_pob_edad[,1]!="Total",]%>%group_by(Edad)%>%summarise(avg=mean(`Población Desocupada`))%>%
ggplot(aes(Edad, avg))+ylab("Población desocupada promedio")+xlab("Rango de edad")+ggtitle("Figura 1. Población desocupada por rango de edad (2010-2019)")+geom_bar(stat = "identity", fill="yellow")
an_pob_edad[an_pob_edad[,1]!="Total",]%>%group_by(Edad)%>%summarise(avg=mean(`Población Desocupada`))%>%
ggplot(aes(Edad, avg))+ylab("Población desocupada promedio")+xlab("Rango de edad")+ggtitle("Figura 1. Población desocupada por rango de edad (2010-2019)")+geom_bar(stat = "identity", fill="Blue Gray")
an_pob_edad[an_pob_edad[,1]!="Total",]%>%group_by(Edad)%>%summarise(avg=mean(`Población Desocupada`))%>%
ggplot(aes(Edad, avg))+ylab("Población desocupada promedio")+xlab("Rango de edad")+ggtitle("Figura 1. Población desocupada por rango de edad (2010-2019)")+geom_bar(stat = "identity", fill="blue gray")
an_pob_edad[an_pob_edad[,1]!="Total",]%>%group_by(Edad)%>%summarise(avg=mean(`Población Desocupada`))%>%
ggplot(aes(Edad, avg))+ylab("Población desocupada promedio")+xlab("Rango de edad")+ggtitle("Figura 1. Población desocupada por rango de edad (2010-2019)")+geom_bar(stat = "identity", fill="617")
pob_tot_ent <- c(1273404, 3443792, 745601, 897291, 5200849, 3681473, 8870622, 2932657, 713612, 1750791, 5780123, 3551527, 2850714, 7857979, 16672099, 4571000, 1902329, 1206119, 5028766, 3991911, 6144886, 1980225, 1539101, 2733708, 2965379, 2900849, 2364632, 3511463, 1265055, 7998824, 2097203, 1566089)
df1 <- cbind(df, pob_tot_ent)
df1 %>% summarise(tasa_deso=(avg/pob_tot_ent), `Entidad Federativa`) %>%
ggplot(aes(x=reorder(`Entidad Federativa`, -tasa_deso), y=tasa_deso))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Tasa de población desocupada")+
xlab("Entidad Federativa")+
ggtitle("Figura 7. Tasa de población desocupada (2010-2019) vs Entidad Federativa")+
geom_bar(stat = "identity", fill="orange")
TCCO <- read_excel("TCCO.xlsx")
tcco <- read_excel("TCCO.xlsx")
tcco
tcco %>%ggplot(aes(x=Año, y=`TCCO promedio (porcentaje respecto a la PEA)`))+
geom_point()
tcco %>%ggplot(aes(x=factor(Año), y=`TCCO promedio (porcentaje respecto a la PEA)`))+
geom_point()
tcco
18.9/13.8
tcco %>%ggplot(aes(x=factor(Año), y=`TCCO promedio (porcentaje respecto a la PEA)`))+
xlab("Año")
geom_point()
tcco %>%ggplot(aes(x=factor(Año), y=`TCCO promedio (porcentaje respecto a la PEA)`))+
xlab("Año")+
ggtitle("TCCO promedio vs Año" )
geom_point()
tcco %>%ggplot(aes(x=factor(Año), y=`TCCO promedio (porcentaje respecto a la PEA)`))+
xlab("Año")+
ggtitle("TCCO promedio vs Año" )+
geom_point()
tcco %>%ggplot(aes(x=factor(Año), y=`TCCO promedio (porcentaje respecto a la PEA)`))+
xlab("Año")+
ggtitle("Figura 8. TCCO promedio vs Año" )+
geom_point()
seq(2010:2019)
2010:2019
per <- 2010:2019
por <- c(12.0, 11.3, 11.8, 12.0, 11.7, 12.5, 13.8, 13.8, 15.5, 19.0)
tcco <- cbind(per,por)
tcco
tcco %>%ggplot(aes(x=factor(per), y=por))+
xlab("Año")+
ylab("TCCO promedio (porcentaje respecto a la PEA)")+
ggtitle("Figura 8. TCCO vs Año" )+
geom_point()
tcco %>%ggplot(aes(x=factor(per), y=por))+
geom_point()
class(tcco)
per <- 2010:2019
por <- c(12.0, 11.3, 11.8, 12.0, 11.7, 12.5, 13.8, 13.8, 15.5, 19.0)
tcco <- data.frame(per,por)
tcco
tcco %>%ggplot(aes(x=factor(per), y=por))+
xlab("Año")+
ylab("TCCO promedio (porcentaje respecto a la PEA)")+
ggtitle("Figura 8. TCCO vs Año" )+
geom_point()
tcco %>%ggplot(aes(x=factor(per), y=por))+
xlab("Año")+
ylab("TCCO promedio (porcentaje respecto a la PEA)")+
ggtitle("Figura 8. TCCO vs Año" )+
geom_point()+geom_line()
tcco %>%ggplot(aes(x=per, y=por))+
xlab("Año")+
ylab("TCCO promedio (porcentaje respecto a la PEA)")+
ggtitle("Figura 8. TCCO vs Año" )+
geom_point()+geom_line()
tcco %>%ggplot(aes(x=per, y=por))+
xlab("Año")+
ylab("TCCO promedio (porcentaje respecto a la PEA)")+
ggtitle("Figura 8. TCCO vs Año" )+
geom_point()+geom_smooth
tcco %>%ggplot(aes(x=per, y=por))+
xlab("Año")+
ylab("TCCO promedio (porcentaje respecto a la PEA)")+
ggtitle("Figura 8. TCCO vs Año" )+
geom_point()+geom_smooth()
tcco %>%ggplot(aes(x=factor(per), y=por))+
xlab("Año")+
ylab("TCCO promedio (porcentaje respecto a la PEA)")+
ggtitle("Figura 8. TCCO vs Año" )+
geom_point()+geom_smooth()
tcco %>%ggplot(aes(x=per, y=por))+
xlab("Año")+
ylab("TCCO promedio (porcentaje respecto a la PEA)")+
ggtitle("Figura 8. TCCO vs Año" )+
geom_point()+geom_smooth()
19/20
19/12
knitr::opts_chunk$set(echo = TRUE)
library("readxl") #Esta librería permite descargar archivos Excel.
library("tidyverse") #Esta librería contiene múltiples librerías para facilitar el trabajo
pob_edad <- read_excel("INEGI_pob_edad.xls")
pob_edad[,c(1,2,3)] #Se ven las primeras 3 columnas de la base de datos
names(pob_edad)
n_pob_edad <- pob_edad%>%select(c(-2,-3,-4)) #No contiene datos del año 2020
head(n_pob_edad)
#Se hace un ciclo for para obtener el promedio de los trimestres para cada año
y <- 2019
k <- 0
year_pob_edad <- data.frame(n_pob_edad[,1])
for (i in 1:10){
col <- rowMeans(n_pob_edad[, k+c(2,3,4,5)])
year_pob_edad <- cbind(year_pob_edad, col)
names(year_pob_edad)[i+1]<-y
k <- k+4
y<-y-1
}
head(year_pob_edad) #Se observan los datos
edad_pob_edad <- data.frame("Edad"=c("Total", "15 a 19", "20 a 29", "30 a 39", "40 a 49", "50 a 59", "60≤", "No especificado"))
edad_pob_edad <- data.frame("Edad"=rep(edad_pob_edad[,1], 10))#Se crea data frame con rangos de edad
pob_pob_edad <- data.frame(year_pob_edad[ ,2]) #Se crea un data frame para guardar la población desocupada
#Se hace un ciclo for para acomodar a la población desocupada de manera vertical
c <- 3
k <- 1
for (i in 1:72){
row <- year_pob_edad[k ,c]
pob_pob_edad <- rbind(pob_pob_edad, row)
k <- k+1
if (k==9){
k <- 1
c <- c+1
}
}
pob_pob_edad
y_pob_edad <- data.frame(rep(2019, 8))#Se crea data frame con años
#Se hace un ciclo for para agregar años
y <- 2018
c<-0
for (j in 1:72){
y_pob_edad <- rbind(y_pob_edad, y)
c <- c+1
if (c==8){
c <- 0
y <- y-1
}
}
y_pob_edad
an_pob_edad<-cbind(edad_pob_edad, y_pob_edad, pob_pob_edad)
names(an_pob_edad) <- c("Edad", "Año", "Población Desocupada")
an_pob_edad #Data frame para realizar análisis visual
an_pob_edad[an_pob_edad[,1]!="Total",]%>%group_by(Edad)%>%summarise(avg=mean(`Población Desocupada`))%>%
ggplot(aes(Edad, avg))+ylab("Población desocupada promedio")+xlab("Rango de edad")+ggtitle("Figura 1. Población desocupada por rango de edad (2010-2019)")+geom_bar(stat = "identity", fill="617")
#Bar plot
an_pob_edad[an_pob_edad[,1]!="Total",]%>%group_by(Año)%>%ggplot(aes(x=factor(Año), y=`Población Desocupada`, col=Edad))+xlab("Año")+ggtitle("Figura 2. Población desocupada por año y por rango de edad ")+geom_bar(stat = "identity")
#Base de datos con población desocupada total por año
y_pob <- an_pob_edad[an_pob_edad[,1]!="Total",]%>%group_by(Año)%>%summarise(`Población Desocupada`=sum(`Población Desocupada`))
y_pob
#Scatterplot
y_pob %>% ggplot(aes(x=factor(Año), y=`Población Desocupada`, col=factor(Año)))+xlab("Año")+ggtitle("Figura 3. Población desocupada por año")+geom_point()
an_pob_edad[an_pob_edad[,1]!="Total",]%>%group_by(Año)%>%ggplot(aes(x=Año, y=`Población Desocupada`, col=Edad))+ggtitle("Figura 4. Población desocupada por año y por edad")+geom_line()+geom_point()
pob_ent_fed <- read_excel("INEGI_pob_entfed.xlsx") #Data frame con datos depurados
summary(pob_ent_fed)
head(pob_ent_fed)#Primeros 6 renglones
tail(pob_ent_fed)#Últimas 6 filas
str(pob_ent_fed) #Estructura de la base de datos
levels(factor(pob_ent_fed$`Entidad Federativa`))
levels(factor(pob_ent_fed$`Periodo de encuesta`))
pob_ent_fed1 <- pob_ent_fed%>%filter(!(`Periodo de encuesta` %in% c("Cuarto trimestre del 2020", "Tercer trimestre del 2020", "Primer trimestre del 2020")))
pob_ent_fed1
pob_ent_fed1[1:4,]
k <- 0
y <- 2019
avg <- data.frame()
year <- data.frame()
ent <- data.frame()
for (i in 1:330){
tot_avg <- colMeans(pob_ent_fed1[k+1:4,"Total"])
avg <- rbind(avg, tot_avg)
ent <- rbind(ent, unique(pob_ent_fed1[k+1:4,"Entidad Federativa"]))
k <- k+4
year <- rbind(year, y)
y <- y-1
if (y==2009){
y<-2019
}
}
av_pobent_fed <- cbind(year, avg, ent)
names(av_pobent_fed)<-c("Año", "Población Desocupada", "Entidad Federativa")
av_pobent_fed
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%
ggplot(aes(x=`Entidad Federativa`, y=avg))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Promedio de población desocupada")+
ggtitle("Figura 5. Promedio de población desocupada (2010-2019) vs Estado")+
geom_bar(stat = "identity", fill="forest green")
#Valor promedio de población desempleada en México
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%.$avg%>%max()
#Fila de la Ciudad de México
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%filter(`Entidad Federativa`=="Ciudad de México")
av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%
group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))%>%
ggplot(aes(x=reorder(`Entidad Federativa`, -avg), y=avg))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Promedio de población desocupada")+
xlab("Entidad Federativa")+
ggtitle("Figura 6. Promedio población desocupada (2010-2019) vs Estado (desc.)")+
geom_bar(stat = "identity", fill="forest green")
df <- av_pobent_fed %>% filter(!(`Entidad Federativa` %in% c("Total") ))%>%group_by(`Entidad Federativa`) %>% summarise(avg = mean(`Población Desocupada`))
df
pob_tot_ent <- c(1273404, 3443792, 745601, 897291, 5200849, 3681473, 8870622, 2932657, 713612, 1750791, 5780123, 3551527, 2850714, 7857979, 16672099, 4571000, 1902329, 1206119, 5028766, 3991911, 6144886, 1980225, 1539101, 2733708, 2965379, 2900849, 2364632, 3511463, 1265055, 7998824, 2097203, 1566089)
df1 <- cbind(df, pob_tot_ent)
df1 %>% summarise(tasa_deso=(avg/pob_tot_ent), `Entidad Federativa`) %>%
ggplot(aes(x=reorder(`Entidad Federativa`, -tasa_deso), y=tasa_deso))+
theme(axis.text.x = element_text(angle = 90))+
ylab("Tasa de población desocupada")+
xlab("Entidad Federativa")+
ggtitle("Figura 7. Tasa de población desocupada (2010-2019) vs Entidad Federativa")+
geom_bar(stat = "identity", fill="orange")
per <- 2010:2019
por <- c(12.0, 11.3, 11.8, 12.0, 11.7, 12.5, 13.8, 13.8, 15.5, 19.0)
tcco <- data.frame(per,por)
tcco
tcco %>%ggplot(aes(x=per, y=por))+
xlab("Año")+
ylab("TCCO promedio (porcentaje respecto a la PEA)")+
ggtitle("Figura 8. TCCO vs Año" )+
geom_point()+geom_smooth()
